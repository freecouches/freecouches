// [TODO: map out asana stoof into hurr]

//////////////////////////////////////////
// Verifications and Permissions questions
//////////////////////////////////////////
//QSTN: when to allow Search (P2)
    // TODO: do some competitive analysis
    // TODO: review how verification works and what steps allowed on Couchsurfing, Couchers, and what you can do at different steps
        // Check Asana, Docs.  but it should be on Asana competitive analysis.

//TODO: indicate how long they can expect to wait between stages.
digraph unix {
    compound=true; 
    rankdir="TB"
    labelloc="t";
    newrank=true;

    label = <<FONT POINT-SIZE="18">Guest Flow - Onboarding, Booking, and Reviewing</FONT>>    
    
    user_invited [label="User Invite"]
    waitlist_signup [label="Waitlist Signup"]
    admin_invited [label="Admin Invite"]
    signup [label = "Signup"]
    email_activated [label ="Email Activated"]

    phone_verified [label = "Phone Verified"]
    profile_completed [label ="Profile Completed"]
    search [label="Search"]

    waitlist_signup->admin_invited->signup
    user_invited->signup

    signup->email_activated

    email_activated->search
    email_activated->phone_verified
    email_activated->profile_completed
    email_activated->view_listing

    search->view_listing->request_booking
    profile_completed -> request_booking
    phone_verified -> request_booking
    view_listing [label="View Listing"]
    request_booking [label="Request Booking"]
    request_accepted [label="Host Accepts Request"]
    actual_booking [label="Actual Booking"]
    reviews [label="Guest and Host Review"]
    reviews_on_profile [label="Reviews appear on Profiles"]

    request_booking->request_accepted->actual_booking->reviews
    reviews->reviews_on_profile [label="2 wks"]
    {rank=same;reviews;reviews_on_profile}

    {rank=same;phone_verified;profile_completed;search;view_listing}

    {rank=same;email_activated;table [ shape="square";label = <
    <table border="0">
       <tr><td align="text"><FONT POINT-SIZE="16" COLOR="RED">Failure States</FONT></td></tr>
       <tr><td align="text"><FONT POINT-SIZE="12">• Invite Code Already Used</FONT></td></tr>
       <tr><td align="text"><FONT POINT-SIZE="12">• Guest Banned</FONT></td></tr>
       <tr><td align="text"><FONT POINT-SIZE="12">• Guest Closes Account</FONT></td></tr>
       <tr><td align="text"><FONT POINT-SIZE="12">• Guest Cancels Request</FONT></td></tr>
       <tr><td align="text"><FONT POINT-SIZE="12">• Host Rejects Request</FONT></td></tr>
       <tr><td align="text"><FONT POINT-SIZE="12">• Request Expires</FONT></td></tr>
       <tr><td align="text"><FONT POINT-SIZE="12">• Host Listing Removed</FONT></td></tr>
       <tr><td align="text"><FONT POINT-SIZE="12">• Guest or Host No-Shows</FONT></td></tr>

    </table>
  > ] }

}